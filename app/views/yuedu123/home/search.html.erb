<% if @query_words.present? %>

  <div id="cse" style="width: 100%;">Loading</div>
  <script src="http://www.google.com/jsapi" type="text/javascript"></script>
  <script type="text/javascript"> 
    function parseQueryFromUrl () {
      var queryParamName = "q";
      var search = window.location.search.substr(1);
      var parts = search.split('&');
      for (var i = 0; i < parts.length; i++) {
        var keyvaluepair = parts[i].split('=');
        if (decodeURIComponent(keyvaluepair[0]) == queryParamName) {
          return decodeURIComponent(keyvaluepair[1].replace(/\+/g, ' '));
        }
      }
      return '';
    }

    google.load('search', '1', {language : 'zh-CN', style : google.loader.themes.ESPRESSO});
    google.setOnLoadCallback(function() {
      var customSearchOptions = {};  var customSearchControl = new google.search.CustomSearchControl(
      '007453578348929938944:ovuevlwyhbo', customSearchOptions);
      customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
      var options = new google.search.DrawOptions();
      options.setAutoComplete(true);
      options.enableSearchResultsOnly(); 
      customSearchControl.draw('cse', options);
      var queryFromUrl = parseQueryFromUrl();
      if (queryFromUrl) {
        customSearchControl.execute(queryFromUrl);
      }
    }, true);
  </script>
  <style type="text/css">
    .gsc-control-cse {
      font-family: Georgia, serif;
      border-color: #FFFFFF;
      background-color: #FFFFFF;
    }
    .gsc-tabHeader.gsc-tabhInactive {
      border-color: #A25B08;
      background-color: #A25B08;
    }
    .gsc-tabHeader.gsc-tabhActive {
      border-color: #461200;
      background-color: #461200;
    }
    .gsc-tabsArea {
      border-color: #461200;
    }
    .gsc-webResult.gsc-result,
    .gsc-results .gsc-imageResult {
      border-color: #FFFFFF;
      background-color: #FFFFFF;
    }
    .gsc-webResult.gsc-result:hover,
    .gsc-webResult.gsc-result.gsc-promotion:hover,
    .gsc-imageResult:hover {
      border-color: #FFFFFF;
      background-color: #FFFFFF;
    }
    .gs-webResult.gs-result a.gs-title:link,
    .gs-webResult.gs-result a.gs-title:link b,
    .gs-imageResult a.gs-title:link,
    .gs-imageResult a.gs-title:link b {
      color: #950000;
    }
    .gs-webResult.gs-result a.gs-title:visited,
    .gs-webResult.gs-result a.gs-title:visited b,
    .gs-imageResult a.gs-title:visited,
    .gs-imageResult a.gs-title:visited b {
      color: #950000;
    }
    .gs-webResult.gs-result a.gs-title:hover,
    .gs-webResult.gs-result a.gs-title:hover b,
    .gs-imageResult a.gs-title:hover,
    .gs-imageResult a.gs-title:hover b {
      color: #950000;
    }
    .gs-webResult.gs-result a.gs-title:active,
    .gs-webResult.gs-result a.gs-title:active b,
    .gs-imageResult a.gs-title:active,
    .gs-imageResult a.gs-title:active b {
      color: #950000;
    }
    .gsc-cursor-page {
      color: #950000;
    }
    a.gsc-trailing-more-results:link {
      color: #950000;
    }
    .gs-webResult .gs-snippet,
    .gs-imageResult .gs-snippet,
    .gs-fileFormatType {
      color: #333333;
    }
    .gs-webResult div.gs-visibleUrl,
    .gs-imageResult div.gs-visibleUrl {
      color: #A25B08;
    }
    .gs-webResult div.gs-visibleUrl-short {
      color: #A25B08;
    }
    .gs-webResult div.gs-visibleUrl-short {
      display: block;
    }
    .gs-webResult div.gs-visibleUrl-long {
      display: none;
    }
    .gs-promotion div.gs-visibleUrl-short {
      display: none;
    }
    .gs-promotion div.gs-visibleUrl-long {
      display: block;
    }
    .gsc-cursor-box {
      border-color: #FFFFFF;
    }
    .gsc-results .gsc-cursor-box .gsc-cursor-page {
      border-color: #A25B08;
      background-color: #FFFFFF;
      color: #950000;
    }
    .gsc-results .gsc-cursor-box .gsc-cursor-current-page {
      border-color: #461200;
      background-color: #461200;
      color: #950000;
    }
    .gsc-webResult.gsc-result.gsc-promotion {
      border-color: #FEFEDC;
      background-color: #FFFFCC;
    }
    .gsc-completion-title {
      color: #950000;
    }
    .gsc-completion-snippet {
      color: #333333;
    }
    .gs-promotion a.gs-title:link,
    .gs-promotion a.gs-title:link *,
    .gs-promotion .gs-snippet a:link {
      color: #0000CC;
    }
    .gs-promotion a.gs-title:visited,
    .gs-promotion a.gs-title:visited *,
    .gs-promotion .gs-snippet a:visited {
      color: #0000CC;
    }
    .gs-promotion a.gs-title:hover,
    .gs-promotion a.gs-title:hover *,
    .gs-promotion .gs-snippet a:hover {
      color: #0000CC;
    }
    .gs-promotion a.gs-title:active,
    .gs-promotion a.gs-title:active *,
    .gs-promotion .gs-snippet a:active {
      color: #0000CC;
    }
    .gs-promotion .gs-snippet,
    .gs-promotion .gs-title .gs-promotion-title-right,
    .gs-promotion .gs-title .gs-promotion-title-right *  {
      color: #333333;
    }
    .gs-promotion .gs-visibleUrl,
    .gs-promotion .gs-visibleUrl-short {
      color: #A25B08;
    }
  </style> 



<% else %>
  请输入关键词
<% end %>










<% if false %>
  <% if @query_words.present? %>
    <% if @query_results.present? && @query_results.any? %>
      <% @query_results.each do |result| %>
        <div class="res">
          <div class="res-ttl">
            <%= helper_ferret_result_linker(result, :highlight => true, :query_words => @query_words_used) %>
          </div>
          <div class="res-body">
        <%#= excerpt(result.shared_searcher_content, @query_words) %>
            <%= raw result.highlight(@query_words_used, :field => :content, 
              :pre_tag => "<span class='highlight'>", :post_tag => "</span>") %>
          </div>
        </div>
      <% end %>
      <%= will_paginate @query_results %>
    <% else %>
      <div class="res">
        没有搜到相关结果
      </div>
    <% end %>
  <% else %>
    请输入关键词
  <% end %>
<% end %>